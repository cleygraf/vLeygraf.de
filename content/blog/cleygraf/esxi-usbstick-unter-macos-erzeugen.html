---
kind: article
title: ESXi USB-Stick unter MacOS erzeugen
created_at: 2010-08-16
author: Christoph Leygraf
---

<p style="clear: both">Möchte man mit Hilfe des installierbaren ESXi selbst einen USB-Stick erstellen, von dem ESXi startet, findet man viele Anleitungen im Web. Wie dies jedoch auf einem Mac geht, findet man selten. Darum hier mein Vorgehen, einen bootfähigen ESXi USB-Stick anzufertigen.</p><p style="clear: both">Zuerst öffnet man das ISO-Images des ESXi (in meinem Fall die Datei VMware-VMvisor-Installer-4.1.0-260247.x86_64.iso) mit dem "Festplatten-Dienstprogramm":</p><p style="text-align: left; text-align: left;"><img src="http://www.vLeygraf.de/system/files/Festplattendienstprogramm_0.jpg" height="366" alt="Festplattendienstprogramm" width="480" style="  text-align: center; display: block; margin: 0 auto 10px;" />Es öffnet sich ein Finder-Fenster des gerade "gemounteten" ISO-Image. Von dort kopiert man die Datei imagedd.bz2 in ein Verzeichnis der Wahl, bei mir <span style="font-family: monospace;"><code>~/tmp</code></span><span style="font-family: monospace;">:</span></p><blockquote style="clear: both"><p> <pre style="clear: both">cleygraf@localhost { ~/tmp }$ ls -al total 414808 drwxr-xr-x 3 cleygraf staff 102 30 Jul 20:37 . drwxr-xr-x@ 49 cleygraf staff 1666 30 Jul 20:37 .. -r--r--r-- 1 cleygraf staff 212380054 18 Mai 19:19 imagedd.bz2 cleygraf@localhost { ~/tmp }$ </pre><br /><br /></p></blockquote><p style="clear: both">Mit <code>bunzip</code> kann nun das gewünschte Image für den USB-Stick ausgepackt werden:</p><blockquote style="clear: both"><p> <pre style="clear: both">cleygraf@localhost { ~/tmp }$ bunzip2 imagedd.bz2 cleygraf@localhost { ~/tmp }$ ls -al total 1843200 drwxr-xr-x 3 cleygraf staff 102 30 Jul 20:46 . drwxr-xr-x@ 49 cleygraf staff 1666 30 Jul 20:37 .. -r--r--r-- 1 cleygraf staff 943718400 18 Mai 19:19 imagedd cleygraf@localhost { ~/tmp }$ </pre><br /><br /></p></blockquote><p style="clear: both">Mit Hilfe des <code>diskutil</code> Kommandos stellen wir fest, als welches "Device" unser inzwischen angeschlossener USB-Stick erkannt wird. Bei mir ist es <code>/dev/disk1</code> (<code>/dev/disk0</code> ist die Systemplatte, <code>/dev/disk2</code> meine iDisk und <code>/dev/disk4</code> entspricht dem soeben "gemounteten" ISO-Image):</p><blockquote style="clear: both"><p> <pre style="clear: both">cleygraf@localhost { ~/tmp }$ sudo -s Password: root@localhost { ~/tmp }$ diskutil list /dev/disk0    #: TYPE NAME SIZE IDENTIFIER    0: GUID_partition_scheme *256.1 GB disk0    1: EFI 209.7 MB disk0s1    2: Apple_HFS MacOS X 255.7 GB disk0s2 /dev/disk1    #: TYPE NAME SIZE IDENTIFIER    0: FDisk_partition_scheme *1.1 GB disk1    1: DOS_FAT_16_S Hypervisor0 4.2 MB disk1s4    2: DOS_FAT_16 Hypervisor1 50.3 MB disk1s5    3: DOS_FAT_16 Hypervisor2 50.3 MB disk1s6    4: 0xFC 115.3 MB disk1s7    5: DOS_FAT_16 Hypervisor3 566.2 MB disk1s8 /dev/disk2    #: TYPE NAME SIZE IDENTIFIER    0: Apple_partition_scheme *19.4 GB disk2    1: Apple_partition_map 32.3 KB disk2s1    2: Apple_HFSX cleygraf 19.4 GB disk2s2 /dev/disk4    #: TYPE NAME SIZE IDENTIFIER    0: ESXi Installer v *314.2 MB disk4 root@localhost { ~/tmp }$ </pre><br /><br /></p></blockquote><p style="clear: both">Auf dem USB-Stick ist bereits eine ältere Version von ESXi. Da das System die Partitionen auf dem USB-Stick automatisch "gemountet" hat, müssen diese zuerst "geunmountet" werden:</p><blockquote style="clear: both"><p> <pre style="clear: both">root@localhost { ~/tmp }$ mount /dev/disk0s2 on / (hfs, local, journaled) devfs on /dev (devfs, local, nobrowse) map -hosts on /net (autofs, nosuid, automounted, nobrowse) /dev/disk2s2 on /Volumes/cleygraf (hfs, local, nodev, nosuid, journaled,  noowners, mounted by cleygraf) //cleygraf@fserv1/data1 on /Volumes/data1-1 (smbfs, nodev, nosuid, mounted  by cleygraf) /dev/disk4 on /Volumes/ESXi Installer v (cd9660, local, nodev, nosuid,  read-only, noowners) /dev/disk1s4 on /Volumes/Hypervisor0 (msdos, local, nodev, nosuid, noowners) /dev/disk1s5 on /Volumes/Hypervisor1 (msdos, local, nodev, nosuid, noowners) /dev/disk1s6 on /Volumes/Hypervisor2 (msdos, local, nodev, nosuid, noowners) /dev/disk1s8 on /Volumes/Hypervisor3 (msdos, local, nodev, nosuid, noowners) root@localhost { ~/tmp }$ umount /Volumes/Hypervisor* unount(/Volumes/Hypervisor3): Resource busy -- try 'diskutil unmount' root@localhost { ~/tmp }$ diskutil unmount /Volumes/Hypervisor3 Volume Hypervisor3 on disk1s8 unmounted root@localhost { ~/tmp }$ </pre><br /><br /></p></blockquote><p style="clear: both">Das <code>dd</code> Kommando kopiert die Daten des ESXi-Image auf den USB-Stick:</p><blockquote style="clear: both"><p> <pre style="clear: both">root@localhost { ~/tmp }$ dd if=./imagedd of=/dev/disk1 1843200+0 records in 1843200+0 records out 943718400 bytes transferred in 605.337165 secs (1558996 bytes/sec) root@localhost { ~/tmp }$ </pre><br /><br /></p></blockquote><p style="clear: both">Der Kopiervorgang dauert einige Augenblicke. Danach "mountet" das System die gerade angelegten Partitionen automatisch. Vor Abziehen des USB-Stick empfiehlt sich ein "Unmount", dies kann z. B. auch im Finder erfolgen.</p><p style="clear: both">Anschließed kann der USB-Stick ausprobiert werden.</p><br class='final-break' style='clear: both' />
