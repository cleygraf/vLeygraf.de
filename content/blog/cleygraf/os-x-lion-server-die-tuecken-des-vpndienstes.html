---
kind: article
title: OS X Lion Server - Die Tücken des VPN-Dienstes
created_at: 2012-02-23
author: Christoph Leygraf
---

<p>Mein <em>MacBook Pro 15</em> habe ich gestern zum Server im Keller “degradiert”, denn für einen neuen <em>Mac mini</em> fehlt mir aktuell einfach das Geld.&nbsp;</p><p><!--break--></p><p>Zunächst laufen auf dem System zwei virtuelle Maschinen für mein <em>vSphere5</em>-Labor (der AD- und der vCenter-Server) im Rahmen der Vorbereitung auf die <a href="http://mylearn.vmware.com/mgrReg/plan.cfm?plan=12457&amp;amp;ui=www" target="_blank">VCP5</a>-Prüfung. Als Hypervisor dafür kommt natürlich nur <a href="http://www.vmware.com/de/products/desktop_virtualization/fusion/overview.html" target="_blank">VMware Fusion</a> in Frage, denn so sind die virtuellen Maschinen auch direkt unter <a href="http://www.vmware.com/products/workstation/overview.html" target="_blank">VMware Workstation</a> (unter Windows oder LINUX) nutzbar.</p><p>Parallel dazu habe ich meinen alten <em>Vigor</em> Router ausgemustert und setze stattdessen jetzt eine <a href="http://www.apple.com/airportextreme/" target="_blank">Airport Extreme Basisstation</a> ein. Der alte Router war auch <a href="http://de.wikipedia.org/wiki/Virtual_Private_Network" target="_blank">VPN</a>-Gateway für den Zugriff von draußen, eine Funktionalität die die <em>Airport Extreme</em> Basisstation nicht bietet. Langfristig werde ich deshalb sicher eine weitere virtuelle Maschine als <a href="http://openvpn.net/" target="_blank">OpenVPN</a>-Gateway aufsetzen. Als schnelle Lösung habe ich mir heute nachmittag das Addon <a href="http://www.apple.com/de/server/" target="_blank">Lion Server</a> im <em>App Store</em> gekauft und installiert. Ich wollte den <em>Lion Server</em> schon lange mal ausprobieren und als erstes habe ich mich jetzt an den VPN-Dienst gewagt. Um das VPN auch mit iOS- oder Android-Geräten einfach nutzen zu können, habe ich mich für ein <a href="http://de.wikipedia.org/wiki/L2TP" target="_blank">L2TP</a>-VPN entschieden. Und jetzt kommt der Witz: <em>Lion Server</em> erzeugt automatisch ein zufälliges <em>Shared Secret</em>, dass über das Verbindungsprofil auf die Endgeräte verteilt wird. Natürlich wollte ich das VPN sofort ausprobieren, am einfachsten mit dem iPad über UMTS. Das schlug aber immer fehl: der Verbindungsaufbau zum Server sei angeblich nicht möglich. Also die Protokolle durchgesehen und die <em>Airport Extreme</em> Basisstation neu gestartet. Die wird übrigens automatisch von <em>Lion Server</em> mitkonfiguriert, sodass die notwendigen Ports an das <em>MacBook</em> weitergeleitet werden. Wenn man nicht weiterweiß, dann googelt man. Und siehe da, ein <a href="https://discussions.apple.com/message/15748552#15748552" target="_blank">bekanntes Problem</a>: Das automatisch erzeugte <em>Shared Secret</em> beinhaltet Sonderzeichen, die der iOS-Client nicht verkraftet und die irrführende Fehlermeldung auslöst. Mit <a href="https://agilebits.com/onepassword" target="_blank">1Password</a> habe ich ein zufälliges Passwort als Shared Secret erzeugt, dass kein Sonderzeichen enthält. Und schon klappte es auch mit dem L2TP-VPN. Das Ganze ist aber auch meiner Sicht ziemlich peinlich für Apple! Die ansonsten einfache Inbetriebnahme des VPNs wird durch einen solchen Patzer unnötig schwierig.</p>
