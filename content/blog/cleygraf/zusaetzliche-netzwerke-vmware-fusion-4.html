---
kind: article
title: Zusätzliche Netzwerke in VMware Fusion 4 (Update 21.03.2012)
created_at: 2012-02-22
author: Christoph Leygraf
---

<p>Gerade baue ich mir ein virtuelles <em>vSphere5-Lab</em> unter <em>VMware Fusion</em> auf . Anfangs habe ich für alle virtuellen Maschinen das NAT-Netzwerkinterface verwendet. Das macht besonders für die benötigten Windows-Server Sinn, denn diese müssen ja nach der Installation mit einer Menge Updates versorgt werden. Für die virtuellen ESXi-Server ist dann aber ein separates Netzwerk für's Management eigentlich Pflicht! Ok, dafür ist das "Host-Only"-Netz gut, dass <em>VMware Fusion</em> zur Verfügung stellt. Und was ist jetzt mit <em>vMotion</em> oder Storage-I/O? Weitere Netzwerke bietet VMware Fusion standardmäßig leider nicht an. Wenn man aber nicht vor dem Bearbeiten einiger Textdateien zurückschreckt, sind weitere Netze jedoch kein Problem.</p><p>Zunächst muss dafür <em>VMware Fusion</em> ein weiteres Netzwerkinterface untergeschoben werden. Dies geschieht durch Bearbeiten der Datei <code>/Library/Preferences/VMware Fusion/networking</code>. Dazu benötigt man <em>Superuser-Rechte</em>, d. h. ich habe das <code>sudo</code>-Kommando genutzt:</p><p>&nbsp;</p> <pre><code>cleygraf@Vigor9 { ~ }$ sudo cp /Library/Preferences/VMware\ Fusion/networking /Library/Preferences/VMware\ Fusion/networking<em>120213 Password: cleygraf@Vigor9 { ~ }$ sudo vi /Library/Preferences/VMware\ Fusion/networking cleygraf@Vigor9 { ~ }$ diff /Library/Preferences/VMware\ Fusion/networking</em>120213 /Library/Preferences/VMware\ Fusion/networking 6a7,10 &gt; answer VNET_<em>4_</em>DHCP no &gt; answer VNET_<em>4_</em>HOSTONLY<em>NETMASK 255.255.255.0 &gt; answer VNET_</em>4_<em>HOSTONLY</em>SUBNET 192.168.115.0 &gt; answer VNET_<em>4_</em>VIRTUAL_ADAPTER yes cleygraf@Vigor9 { ~ }$ </code></pre> <p>&nbsp;</p><p>Damit diese Änderung wirksam wird, muss <em>VMware Fusion</em> beendet und wieder gestartet werden. Danach zeigt <code>ifconfig</code> brav auch das neue Interface <code>vmnet4</code> an:</p><p>&nbsp;</p> <pre><code>... vmnet4: flags=8863<up,broadcast,smart,running,simplex,multicast> mtu 1500 ether 00:50:56:c0:00:04 inet 192.168.115.1 netmask 0xffffff00 broadcast 192.168.115.255 ... </up,broadcast,smart,running,simplex,multicast></code></pre> <p>&nbsp;</p><p>Um das zusätzliche Netzwerk jetzt auch für eine VM nutzbar zu machen, muss die VMX-Datei der jeweiligen VM bearbeitet werden:</p><p>&nbsp;</p> <pre><code>cleygraf@Vigor9 { ...lized/nas.lab.leyux.org.vmwarevm }$ cp nas.lab.leyux.org.vmx nas.lab.leyux.org.vmx<em>120214 cleygraf@Vigor9 { ...lized/nas.lab.leyux.org.vmwarevm }$ vi nas.lab.leyux.org.vmx cleygraf@Vigor9 { ...lized/nas.lab.leyux.org.vmwarevm }$ diff -w nas.lab.leyux.org.vmx</em>120214 nas.lab.leyux.org.vmx 84a81,94 &gt; ethernet1.connectionType = "custom" &gt; ethernet1.vnet = "vmnet4" &gt; ethernet1.bsdName = "vmnet4" &gt; ethernet1.displayName = "Custom Host Only VMnet4" &gt; ethernet1.present = "TRUE" &gt; ethernet1.virtualDev = "e1000" &gt; ethernet1.addressType = "generated" &gt; ethernet1.pciSlotNumber = "36" &gt; ethernet1.generatedAddress = "00:0c:29:9b:2f:38" &gt; ethernet1.generatedAddressOffset = "10" cleygraf@Vigor9 { ...lized/nas.lab.leyux.org.vmwarevm }$ </code></pre> <p>&nbsp;</p><p>Da die hier verwendetet VM namens "nas.lab.leyux.org" bereits ein Netzwerkinterface besitzt, füge ich hier statt <code>ethernet0</code> ein zweites Interface <code>ethernet1</code> hinzu. Die ersten sechs Zeilen habe ich manuell am Ende der VMX-Datei angehängt. Beim ersten Start der VM fügt <em>VMware Fusion</em> dann selbst noch die folgenden Zeilen hinzu:</p><p>&nbsp;</p> <pre><code>ethernet1.addressType = "generated" ethernet1.pciSlotNumber = "36" ethernet1.generatedAddress = "00:0c:29:9b:2f:38" ethernet1.generatedAddressOffset = "10" </code></pre> <p>&nbsp;</p><p>Verwendet habe ich die Hinweise von <a href="http://www.thomasvachon.com/2011/09/14/adding-vmnets-in-vmware-fusion-4/">Thomas Vachon</a>. Das Netzwerkinterface erschien bei mir jedoch erst in der VM, nachdem ich zwei weitere Zeilen an die VMX-Datei angehängt hatte:</p><p>&nbsp;</p> <pre><code>ethernet1.present = "TRUE" ethernet1.virtualDev = "e1000" </code></pre> <p>&nbsp;</p><p><u><strong>Update 21.03.2012:</strong></u></p><p>Leider sind bei der Formatierung einige "_" verlorengegangen. Das habe ich korrigiert und zusätzlich steht meine Datei&nbsp;<a href="/system/files/File/networking."><span style="font-family: 'Courier New', 'DejaVu Sans Mono', monospace; font-size: 18px; ">/Library/Preferences/VMware Fusion/networking</span></a> zum Download zur Verfügung.</p>
